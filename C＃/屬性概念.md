

這份筆記將深入介紹 C# 中屬性 (Properties) 的基本概念與用法。

屬性是 C# 提供的一種強大功能，它結合了 [[欄位]] (Fields) 和 [[方法]] (Methods) 的優點，讓我們能夠以更簡潔、更安全的方式來存取物件的資料。

## 為什麼需要屬性？

在物件導向程式設計中，我們通常希望對物件的內部資料 (fields) 進行封裝，避免外部程式直接存取和修改。傳統上，我們會透過 `Get` 和 `Set` 方法來操作這些私有欄位，例如：

```csharp
public class Person
{
	private DateTime _birthdate; // 私有欄位，通常以底線開頭	
	// 傳統的透過方法存取欄位的方式
	public void SetBirthdate(DateTime value)
	{
		this._birthdate = value;
	}
	
	public DateTime GetBirthdate()
	{
		return _birthdate;
	}
}
```

這種方法在程式碼量較大時會顯得相當繁瑣。如果一個類別有多個欄位需要這樣存取，程式設計師就需要為每個欄位編寫兩個方法 (Get 和 Set)，導致程式碼冗長且重複。

為了解決這個問題，C# 引入了屬性 (Property) 的概念。

## 屬性 (Property) 的基本語法

屬性允許您以欄位的方式來存取資料，但在幕後，它會自動呼叫 `get` 和 `set` 存取子 (accessor)，實現了與 `Get` 和 `Set` 方法相同的功能，但語法更簡潔。

以下是一個 `Person` 類別範例，展示了如何使用屬性來簡化對 `_birthdate` 欄位的存取：

```csharp
namespace PropertiesBasic
{
	public class Person
	{
		private DateTime _birthdate;
		
		// 使用 property 的寫法可以簡化以上 Get/Set 方法的寫法
		public DateTime Birthdate // Pascal Case 命名規範 (首字母大寫)
		{
			get { return _birthdate; } // get 存取子：用於讀取 _birthdate 的值
			
			set { _birthdate = value; } // set 存取子：用於設定 _birthdate 的值，value 是隱含的傳入值
		}
	}
}
```

## 如何使用屬性？

使用屬性就像使用公共欄位一樣簡單。以下是一個簡單的範例：

```csharp
using System;
using PropertiesBasic; // 引入包含 Person 類別的命名空間

public class ProgramExample
{
	public static void Main(string[] args)
	{
		Person person = new Person();
		
		// 設定 Birthdate 屬性 (內部呼叫 set 存取子)
		person.Birthdate = new DateTime(1995, 5, 10);
		
		// 讀取 Birthdate 屬性 (內部呼叫 get 存取子)
		Console.WriteLine($"出生日期: {person.Birthdate.ToShortDateString()}");
	}
}
```

## 總結

屬性是 C# 中實現封裝的重要機制。它讓程式碼更簡潔，同時也提供了對資料存取邏輯的控制能力，例如您可以在 `set` 存取子中加入驗證邏輯，確保資料的有效性。在 ASP.NET Core MVC 中，模型 (Models) 中的資料定義大量使用了屬性，因此理解屬性對於後續學習非常重要。

[[屬性MOC]]

#tags: #OOP #Property
